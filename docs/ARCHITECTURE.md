# 아키텍처 (Architecture)

> ℹ️ **참고**
> 이 문서는 시스템의 전반적인 아키텍처 개요를 설명합니다.
> 실제 코드 예시와 상세한 개발 방법론은 **[신규 개발자 필독 가이드](./DEVELOPER_GUIDE.md)**를 참조하세요.

## 1. 개요 (Overview)

이 문서는 프로젝트의 기술적인 아키텍처, 핵심 설계 원칙, 그리고 코드의 실행 흐름을 설명합니다. 이 문서를 통해 개발자들은 시스템의 전체적인 구조를 이해하고, 일관된 방식으로 코드를 개발 및 유지보수할 수 있습니다.

## 2. 시스템 아키텍처 다이어그램 (System Architecture Diagram)

이 애플리케이션은 전통적인 **MVC(Model-View-Controller) 아키텍처 패턴**을 기반으로 설계되었습니다. 사용자 요청부터 응답까지의 흐름은 다음과 같습니다.

```
  [사용자 요청]
       |
       v
[웹 서버 (e.g., Nginx, Apache)]
       |
       v
[public/index.php (엔트리포인트)]
       |
       |--> [오토로더]
       |--> [환경변수 로드]
       |--> [의존성 주입 컨테이너(DI Container) 초기화]
       |
       v
[라우터 (Router)]
       |  (URI와 HTTP 메소드를 기반으로 적절한 컨트롤러 매핑)
       |
       |--> [미들웨어 (Middleware)] (e.g., 인증, 권한 검사)
       |
       v
[컨트롤러 (Controller)]
       |  (사용자 입력 처리 및 비즈니스 로직 호출)
       |
       v
[서비스 (Service)]
       |  (핵심 비즈니스 로직 수행)
       |
       v
[리포지토리 (Repository)]
       |  (데이터베이스와의 상호작용)
       |
       v
[데이터베이스 (Database)]
       |
       v
[뷰 (View) 또는 JSON 응답]
       |
       v
  [사용자 응답]

```

## 3. 주요 기술 스택 (Technology Stack)

-   **Backend**: PHP
-   **Frontend**: HTML, CSS, JavaScript (jQuery, Bootstrap 등 라이브러리 사용)
-   **Database**: MySQL/MariaDB (설정 파일 기준)
-   **Web Server**: Nginx, Apache 등
-   **Dependency Management**: Composer

## 4. 애플리케이션 엔트리포인트 (Application Entrypoint)

애플리케이션의 모든 HTTP 요청은 `public/index.php` 파일을 통해 시작됩니다. 이 파일의 주요 책임은 다음과 같습니다.

### 4.1. `public/index.php`의 역할과 책임

1.  **의존성 로딩**: `vendor/autoload.php`를 통해 Composer로 관리되는 모든 클래스와 라이브러리를 로드합니다.
2.  **환경변수 설정**: `.env` 파일에 정의된 환경변수(데이터베이스 접속 정보, API 키 등)를 애플리케이션에 로드합니다.
3.  **의존성 주입(DI) 컨테이너 설정**: 애플리케이션의 핵심 컴포넌트들(Database, Session, Request 등)과 서비스, 리포지토리, 컨트롤러를 DI 컨테이너에 등록합니다. 이를 통해 클래스 간의 의존성을 중앙에서 관리하고 코드의 결합도를 낮춥니다.
4.  **세션 관리**: 사용자 세션을 시작하고, 보안을 위해 세션 ID를 재발급합니다.
5.  **라우터 초기화 및 라우트 로딩**: 라우터 객체를 생성하고 `routes/web.php`와 `routes/api.php`에 정의된 라우팅 규칙을 로드합니다.
6.  **요청 처리**: 라우터의 `dispatch()` 메소드를 호출하여 현재 요청에 맞는 컨트롤러와 메소드를 실행시킵니다.

### 4.2. 부트스트래핑 과정 (Bootstrapping Process)

부트스트래핑은 애플리케이션이 요청을 처리하기 위해 필요한 모든 환경을 설정하는 과정이며, `public/index.php`에서 순차적으로 진행됩니다.

1.  **초기화**: Composer 오토로더와 환경변수가 가장 먼저 로드됩니다.
2.  **컨테이너 빌드**: DI 컨테이너가 생성되고, 애플리케이션 전역에서 사용될 핵심 객체들이 '싱글턴'으로 등록됩니다. 이후 리포지토리, 서비스, 컨트롤러 순서로 의존성을 해결하며 컨테이너에 등록됩니다.
3.  **라우팅 설정**: 라우터가 미들웨어와 라우트 정보를 로드하여 요청을 처리할 준비를 마칩니다.
4.  **디스패치**: 모든 설정이 완료된 후, 라우터가 실제 요청을 분석하여 해당 로직을 실행합니다.

## 5. 핵심 실행 흐름 (Core Execution Flow)

1.  사용자의 모든 요청은 웹 서버를 통해 `public/index.php`로 전달됩니다.
2.  `index.php`는 애플리케이션을 부트스트래핑합니다.
3.  `Router`는 요청된 URI를 분석하여 `routes/web.php` 또는 `routes/api.php`에 정의된 경로와 일치하는 것을 찾습니다.
4.  경로에 미들웨어(`auth`, `permission` 등)가 지정되어 있다면, 해당 미들웨어가 먼저 실행되어 요청을 검증합니다.
5.  미들웨어를 통과하면, 라우터는 DI 컨테이너를 통해 해당 컨트롤러의 인스턴스를 생성하고, 지정된 메소드를 호출합니다.
6.  `Controller`는 `Request` 객체로부터 사용자 입력을 받고, 비즈니스 로직을 처리하기 위해 적절한 `Service`를 호출합니다.
7.  `Service`는 비즈니스 규칙을 적용하고, 데이터 처리가 필요한 경우 `Repository`를 통해 데이터베이스와 통신합니다.
8.  `Repository`는 데이터베이스로부터 데이터를 조회하거나 변경하는 역할을 수행합니다.
9.  처리 결과는 다시 컨트롤러로 반환되며, 컨트롤러는 이 데이터를 `View`에 전달하여 HTML을 렌더링하거나, `JsonResponse`를 통해 API 응답을 생성합니다.
10. 최종 결과(HTML 또는 JSON)가 사용자에게 반환됩니다.